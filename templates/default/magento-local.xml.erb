<?xml version="1.0"?>
<!--
/**
 * Generated by Chef
 */
-->
<config>
    <global>
        <environment><![CDATA[<%=@magento['environment']%>]]></environment>
        <install>
            <date><![CDATA[Thu, 01 Jul 2010 10:29:20 +0000]]></date>
        </install>
        <crypt>
            <key><![CDATA[<%= @magento['app']['crypt_key']%>]]></key>
        </crypt>
        <disable_local_modules>false</disable_local_modules>
        <%= @magento['global']['custom'] %>

        <% (@magento['global']['extra_params'] || {}).each do |key, value| %>
        <<%= key %>><![CDATA[<%= value %>]]></<%= key %>>
        <% end %>
        <resources>
            <db>
                <table_prefix><![CDATA[<%= @magento['table_prefix'] %>]]></table_prefix>
            </db>
            <% @magento['db_connections'].each do |name, connection|
                next if connection.nil? %>
            <<%= connection['name_override'] || name %>>
                <connection>
                    <% if connection['use'] %>
                    <use><![CDATA[<%= connection['use'] %>]]></use>
                    <% else %>
                      <% @magento['db'].merge(connection).each do |key, value|
                           key = 'dbname' if key == 'database'
                           next if value.nil? %>
                    <<%= key %>><![CDATA[<%= value %>]]></<%= key %>>
                      <% end %>
                    <% end %>
                </connection>
            </<%= connection['name_override'] || name %>>
            <% end %>
        </resources>
        <% if @magento['app']['multi_session_save'] === 'redis' %>
        <session_save><![CDATA[db]]></session_save>
        <redis_session>
            <host><![CDATA[<%= @magento['redis']['host'] %>]]></host>
             <port><![CDATA[<%= @magento['redis']['port'] %>]]></port>
             <timeout><![CDATA[<%= @magento['redis']['timeout'] %>]]></timeout>
             <db><![CDATA[<%= @magento['redis']['session_database'] %>]]></db>
             <compression_threshold><![CDATA[<%= @magento['redis']['compress_threshold'] %>]]></compression_threshold><!-- Set to 0 to disable compression -->
             <compression_lib><![CDATA[<%= @magento['redis']['compression_lib'] %>]]></compression_lib><!-- gzip, lzf or snappy -->
        </redis_session>
        <% else %>
        <session_save><![CDATA[<%= @magento['app']['multi_session_save'] %>]]></session_save>
        <% if @magento['app']['multi_session_save'] == "memcache" %>
        <session_save_path><![CDATA[tcp://<%= @magento['app']['session_memcache_ip'] %>:<%= @magento['app']['session_memcache_port'] %>?persistent=1&weight=1&timeout=10&retry_interval=10]]></session_save_path><!-- e.g. for memcache session save handler tcp://10.0.0.1:11211?persistent=1&weight=2&timeout=10&retry_interval=10 -->
        <% end %>
        <% end %>
        <session_cache_limiter><![CDATA[nocache]]></session_cache_limiter><!-- see http://php.net/manual/en/function.session-cache-limiter.php#82174 for possible values -->
        <cache>
             <backend><![CDATA[<%= @magento['app']['backend_cache'] %>]]></backend><!-- apc / memcached / xcache / Cm_Cache_Backend_Redis empty=file -->
             <% if @magento['app']['backend_cache'] === 'Cm_Cache_Backend_Redis' %>
                <backend_options>
                    <server><![CDATA[<%= @magento['redis']['host'] %>]]></server> <!-- or absolute path to unix socket for better performance -->
                     <port><![CDATA[<%= @magento['redis']['port'] %>]]></port>
                     <database><![CDATA[<%= @magento['redis']['database'] %>]]></database>
                     <force_standalone><![CDATA[<%= @magento['redis']['force_standalone'] %>]]></force_standalone><!-- 0 for phpredis, 1 for standalone PHP -->
                     <automatic_cleaning_factor><![CDATA[<%= @magento['redis']['automatic_cleaning_factor'] %>]]></automatic_cleaning_factor> <!-- Disabled by default -->
                     <compress_data><![CDATA[<%= @magento['redis']['compress_data'] %>]]></compress_data><!-- 0-9 for compression level, recommended: 0 or 1 -->
                     <compress_tags><![CDATA[<%= @magento['redis']['compress_tags'] %>]]></compress_tags><!-- 0-9 for compression level, recommended: 0 or 1 -->
                     <compress_threshold><![CDATA[<%= @magento['redis']['compress_threshold'] %>]]></compress_threshold><!-- Strings below this size will not be compressed -->
                     <compression_lib><![CDATA[<%= @magento['redis']['compression_lib'] %>]]></compression_lib> <!-- Supports gzip, lzf and snappy -->
                </backend_options>
             <% else %>
             <slow_backend><![CDATA[<%= @magento['app']['slow_backend'] %>]]></slow_backend> <!-- database / file (default) - used for 2 levels cache setup, necessary for all shared memory storages -->
             <slow_backend_store_data><![CDATA[0]]></slow_backend_store_data>
             <auto_refresh_fast_cache><![CDATA[0]]></auto_refresh_fast_cache>
             <lifetime><![CDATA[259200]]></lifetime>
             <% if @magento['app']['backend_cache'] == "memcached" %>
             <memcached><!-- memcached cache backend related config -->
               <servers><!-- any number of server nodes can be included -->
                   <% @magento['app']['backend_servers'].each do |server| %>
                     <server>
                         <host><![CDATA[<%= server['host'] %>]]></host>
                         <port><![CDATA[<%= server['port'] %>]]></port>
                         <persistent><![CDATA[<%= server['persistent'] %>]]></persistent>
                         <weight><![CDATA[<%= server['weight'] %>]]></weight>
                         <timeout><![CDATA[<%= server['timeout'] %>]]></timeout>
                         <retry_interval><![CDATA[<%= server['retry_interval'] %>]]></retry_interval>
                         <status><![CDATA[<%= server['status'] %>]]></status>
                     </server>
                 <% end %>
                 </servers>
                 <compression><![CDATA[0]]></compression>
                 <cache_dir><![CDATA[]]></cache_dir>
                 <hashed_directory_level><![CDATA[]]></hashed_directory_level>
                 <hashed_directory_umask><![CDATA[]]></hashed_directory_umask>
                 <file_name_prefix><![CDATA[]]></file_name_prefix>
             </memcached>
             <% end %>
             <% end %>
             <% if @magento['app']['cache_prefix'] != nil %><prefix><![CDATA[<%= @magento['app']['cache_prefix'] %>]]></prefix><% end %>
        </cache>

        <full_page_cache>
             <backend><![CDATA[<%= @magento['app']['backend_cache'] %>]]></backend><!-- apc / memcached / xcache / Cm_Cache_Backend_Redis empty=file -->
             <% if @magento['app']['backend_cache'] === 'Cm_Cache_Backend_Redis' %>
                 <backend_options>
                     <server><![CDATA[<%= @magento['redis']['host'] %>]]></server> <!-- or absolute path to unix socket for better performance -->
                     <port><![CDATA[<%= @magento['redis']['port'] %>]]></port>
                     <database><![CDATA[<%= @magento['redis']['full_page_cache_database'] %>]]></database>
                     <force_standalone><![CDATA[<%= @magento['redis']['force_standalone'] %>]]></force_standalone><!-- 0 for phpredis, 1 for standalone PHP -->
                     <automatic_cleaning_factor><![CDATA[<%= @magento['redis']['automatic_cleaning_factor'] %>]]></automatic_cleaning_factor> <!-- Disabled by default -->
                     <compress_data><![CDATA[<%= @magento['redis']['compress_data'] %>]]></compress_data><!-- 0-9 for compression level, recommended: 0 or 1 -->
                     <compress_tags><![CDATA[<%= @magento['redis']['compress_tags'] %>]]></compress_tags><!-- 0-9 for compression level, recommended: 0 or 1 -->
                     <compress_threshold><![CDATA[<%= @magento['redis']['compress_threshold'] %>]]></compress_threshold><!-- Strings below this size will not be compressed -->
                     <compression_lib><![CDATA[<%= @magento['redis']['compression_lib'] %>]]></compression_lib> <!-- Supports gzip, lzf and snappy -->
                 </backend_options>
             <% else %>
                 <slow_backend><![CDATA[<%= @magento['app']['slow_backend'] %>]]></slow_backend> <!-- database / file (default) - used for 2 levels cache setup, necessary for all shared memory storages -->
                 <slow_backend_store_data><![CDATA[0]]></slow_backend_store_data>
                 <auto_refresh_fast_cache><![CDATA[0]]></auto_refresh_fast_cache>
                 <lifetime><![CDATA[259200]]></lifetime>
                 <% if @magento['app']['backend_cache'] == "memcached" %>
                     <memcached><!-- memcached cache backend related config -->
                         <servers><!-- any number of server nodes can be included -->
                         <% @magento['app']['backend_servers'].each do |server| %>
                             <server>
                                 <host><![CDATA[<%= server['host'] %>]]></host>
                                 <port><![CDATA[<%= server['port'] %>]]></port>
                                 <persistent><![CDATA[<%= server['persistent'] %>]]></persistent>
                                 <weight><![CDATA[<%= server['weight'] %>]]></weight>
                                 <timeout><![CDATA[<%= server['timeout'] %>]]></timeout>
                                 <retry_interval><![CDATA[<%= server['retry_interval'] %>]]></retry_interval>
                                 <status><![CDATA[<%= server['status'] %>]]></status>
                             </server>
                         <% end %>
                         </servers>
                         <compression><![CDATA[0]]></compression>
                         <cache_dir><![CDATA[]]></cache_dir>
                         <hashed_directory_level><![CDATA[]]></hashed_directory_level>
                         <hashed_directory_umask><![CDATA[]]></hashed_directory_umask>
                         <file_name_prefix><![CDATA[]]></file_name_prefix>
                     </memcached>
                 <% end %>
             <% end %>
             <% if @magento['app']['fpc_prefix'] != nil %><prefix><![CDATA[<%= @magento['app']['fpc_prefix'] %>]]></prefix><% end %>
        </full_page_cache>
    </global>
    <admin>
        <routers>
            <adminhtml>
                <args>
                    <frontName><![CDATA[<%= @magento['app']['admin_frontname'] %>]]></frontName>
                </args>
            </adminhtml>
        </routers>
    </admin>
</config>
