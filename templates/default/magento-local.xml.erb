<?xml version="1.0"?>
<!--
/**
 * Generated by Chef
 */
-->
<config>
    <global>
        <environment><![CDATA[<%=@magento['environment']%>]]></environment>
        <install>
            <date><![CDATA[Thu, 01 Jul 2010 10:29:20 +0000]]></date>
        </install>
        <crypt>
            <key><![CDATA[<%= @magento['app']['crypt_key']%>]]></key>
        </crypt>
        <disable_local_modules>false</disable_local_modules>
        <%= @magento['global']['custom'] %>

        <% (@magento['global']['extra_params'] || {}).each do |key, value| %>
        <<%= key %>><![CDATA[<%= value %>]]></<%= key %>>
        <% end %>
        <resources>
            <db>
                <table_prefix><![CDATA[<%= @magento['table_prefix'] %>]]></table_prefix>
            </db>
            <% @magento['db_connections'].each do |name, connection|
                next if connection.nil? %>
            <<%= connection['name_override'] || name %>>
                <connection>
                    <% if connection['use'] %>
                    <use><![CDATA[<%= connection['use'] %>]]></use>
                    <% else %>
                      <% @magento['db'].merge(connection).each do |key, value|
                           key = 'dbname' if key == 'database'
                           next if value.nil? %>
                    <<%= key %>><![CDATA[<%= value %>]]></<%= key %>>
                      <% end %>
                    <% end %>
                </connection>
            </<%= connection['name_override'] || name %>>
            <% end %>
        </resources>
        <% if @magento['app']['multi_session_save'] === 'redis' %>
        <session_save><![CDATA[db]]></session_save>
        <redis_session>
            <host><![CDATA[<%= @magento['redis']['host'] %>]]></host>
             <port><![CDATA[<%= @magento['redis']['port'] %>]]></port>
             <password><![CDATA[<%= @magento['redis']['password'] %>]]></password><!-- Specify if your Redis server requires authentication -->
             <timeout><![CDATA[<%= @magento['redis']['timeout'] %>]]></timeout>
             <persistent><![CDATA[<%= @magento['redis']['session_persistent'] %>]]></persistent> <!-- Specify unique string to enable persistent connections. E.g.: sess-db0; bugs with phpredis and php-fpm are known: https://github.com/nicolasff/phpredis/issues/70 -->
             <db><![CDATA[<%= @magento['redis']['session_database'] %>]]></db>
             <compression_threshold><![CDATA[<%= @magento['redis']['compress_threshold'] %>]]></compression_threshold><!-- Set to 0 to disable compression -->
             <compression_lib><![CDATA[<%= @magento['redis']['compression_lib'] %>]]></compression_lib><!-- gzip, lzf or snappy -->
             <log_level><![CDATA[<%= @magento['redis']['log_level'] %>]]></log_level><!-- 0 (emergency: system is unusable), 4 (warning; additional information, recommended), 5 (notice: normal but significant condition), 6 (info: informational messages), 7 (debug: the most information for development/testing) -->
             <max_concurrency><![CDATA[<%= @magento['redis']['max_concurrency'] %>]]></max_concurrency><!-- maximum number of processes that can wait for a lock on one session; for large production clusters, set this to at least 10% of the number of PHP processes -->
             <break_after_frontend><![CDATA[<%= @magento['redis']['break_after_frontend'] %>]]></break_after_frontend><!-- seconds to wait for a session lock in the frontend; not as critical as admin -->
             <fail_after><![CDATA[<%= @magento['redis']['fail_after'] %>]]></fail_after><!-- seconds after which we bail from attempting to obtain lock (in addition to break after time) -->
             <break_after_adminhtml><![CDATA[<%= @magento['redis']['break_after_adminhtml'] %>]]></break_after_adminhtml>
             <first_lifetime><![CDATA[<%= @magento['redis']['first_lifetime'] %>]]></first_lifetime><!-- Lifetime of session for non-bots on the first write. 0 to disable -->
             <bot_first_lifetime><![CDATA[<%= @magento['redis']['bot_first_lifetime'] %>]]></bot_first_lifetime><!-- Lifetime of session for bots on the first write. 0 to disable -->
             <bot_lifetime><![CDATA[<%= @magento['redis']['bot_lifetime'] %>]]></bot_lifetime><!-- Lifetime of session for bots on subsequent writes. 0 to disable -->
             <disable_locking><![CDATA[<%= @magento['redis']['disable_locking'] %>]]></disable_locking><!-- Disable session locking entirely. -->
             <min_lifetime><![CDATA[<%= @magento['redis']['min_lifetime'] %>]]></min_lifetime><!-- Set the minimum session lifetime -->
             <max_lifetime><![CDATA[<%= @magento['redis']['max_lifetime'] %>]]></max_lifetime><!-- Set the maximum session lifetime -->
        </redis_session>
        <% else %>
        <session_save><![CDATA[<%= @magento['app']['multi_session_save'] %>]]></session_save>
        <% if @magento['app']['multi_session_save'] == "memcache" %>
        <session_save_path><![CDATA[tcp://<%= @magento['app']['session_memcache_ip'] %>:<%= @magento['app']['session_memcache_port'] %>?persistent=1&weight=1&timeout=10&retry_interval=10]]></session_save_path><!-- e.g. for memcache session save handler tcp://10.0.0.1:11211?persistent=1&weight=2&timeout=10&retry_interval=10 -->
        <% end %>
        <% end %>
        <session_cache_limiter><![CDATA[nocache]]></session_cache_limiter><!-- see http://php.net/manual/en/function.session-cache-limiter.php#82174 for possible values -->
        <cache>
             <backend><![CDATA[<%= @magento['app']['backend_cache'] %>]]></backend><!-- apc / memcached / xcache / Cm_Cache_Backend_Redis empty=file -->
             <% if @magento['app']['backend_cache'] === 'Cm_Cache_Backend_Redis' %>
                <backend_options>
                    <server><![CDATA[<%= @magento['redis']['host'] %>]]></server> <!-- or absolute path to unix socket for better performance -->
                     <port><![CDATA[<%= @magento['redis']['port'] %>]]></port>
                     <persistent><![CDATA[<%= @magento['redis']['persistent'] %>]]></persistent><!-- Specify unique string to enable persistent connections. E.g.: sess-db0; bugs with phpredis and php-fpm are known: https://github.com/nicolasff/phpredis/issues/70 -->
                     <database><![CDATA[<%= @magento['redis']['database'] %>]]></database>
                     <force_standalone><![CDATA[<%= @magento['redis']['force_standalone'] %>]]></force_standalone><!-- 0 for phpredis, 1 for standalone PHP -->
                     <connect_retries><![CDATA[<%= @magento['redis']['connect_retries'] %>]]></connect_retries><!-- Reduces errors due to random connection failures; a value of 1 will not retry after the first failure -->
                     <automatic_cleaning_factor><![CDATA[<%= @magento['redis']['automatic_cleaning_factor'] %>]]></automatic_cleaning_factor> <!-- Disabled by default -->
                     <compress_data><![CDATA[<%= @magento['redis']['compress_data'] %>]]></compress_data><!-- 0-9 for compression level, recommended: 0 or 1 -->
                     <compress_tags><![CDATA[<%= @magento['redis']['compress_tags'] %>]]></compress_tags><!-- 0-9 for compression level, recommended: 0 or 1 -->
                     <compress_threshold><![CDATA[<%= @magento['redis']['compress_threshold'] %>]]></compress_threshold><!-- Strings below this size will not be compressed -->
                     <compression_lib><![CDATA[<%= @magento['redis']['compression_lib'] %>]]></compression_lib> <!-- Supports gzip, lzf and snappy -->
                     <use_lua><![CDATA[<%= @magento['redis']['use_lua'] %>]]></use_lua><!-- Set to 1 if Lua scripts should be used for some operations -->
                </backend_options>
             <% else %>
             <slow_backend><![CDATA[<%= @magento['app']['slow_backend'] %>]]></slow_backend> <!-- database / file (default) - used for 2 levels cache setup, necessary for all shared memory storages -->
             <slow_backend_store_data><![CDATA[0]]></slow_backend_store_data>
             <auto_refresh_fast_cache><![CDATA[0]]></auto_refresh_fast_cache>
             <lifetime><![CDATA[259200]]></lifetime>
             <% if @magento['app']['backend_cache'] == "memcached" %>
             <memcached><!-- memcached cache backend related config -->
               <servers><!-- any number of server nodes can be included -->
                   <% @magento['app']['backend_servers'].each do |server| %>
                     <server>
                         <host><![CDATA[<%= server[:host] %>]]></host>
                         <port><![CDATA[<%= server[:port] %>]]></port>
                         <persistent><![CDATA[<%= server[:persistent] %>]]></persistent>
                         <weight><![CDATA[<%= server[:weight] %>]]></weight>
                         <timeout><![CDATA[<%= server[:timeout] %>]]></timeout>
                         <retry_interval><![CDATA[<%= server[:retry_interval] %>]]></retry_interval>
                         <status><![CDATA[<%= server[:status] %>]]></status>
                     </server>
                 <% end %>
                 </servers>
                 <compression><![CDATA[0]]></compression>
                 <cache_dir><![CDATA[]]></cache_dir>
                 <hashed_directory_level><![CDATA[]]></hashed_directory_level>
                 <hashed_directory_umask><![CDATA[]]></hashed_directory_umask>
                 <file_name_prefix><![CDATA[]]></file_name_prefix>
             </memcached>
             <% end %>
             <% end %>
             <% if @magento['app']['cache_prefix'] != nil %><prefix><![CDATA[<%= @magento['app']['cache_prefix'] %>]]></prefix><% end %>
        </cache>

        <full_page_cache>
             <backend><![CDATA[<%= @magento['app']['backend_cache'] %>]]></backend><!-- apc / memcached / xcache / Cm_Cache_Backend_Redis empty=file -->
             <% if @magento['app']['backend_cache'] === 'Cm_Cache_Backend_Redis' %>
                 <backend_options>
                     <server><![CDATA[<%= @magento['redis']['host'] %>]]></server> <!-- or absolute path to unix socket for better performance -->
                     <port><![CDATA[<%= @magento['redis']['port'] %>]]></port>
                     <database><![CDATA[<%= @magento['redis']['full_page_cache_database'] %>]]></database>
                     <force_standalone><![CDATA[<%= @magento['redis']['force_standalone'] %>]]></force_standalone><!-- 0 for phpredis, 1 for standalone PHP -->
                     <automatic_cleaning_factor><![CDATA[<%= @magento['redis']['automatic_cleaning_factor'] %>]]></automatic_cleaning_factor> <!-- Disabled by default -->
                     <compress_data><![CDATA[<%= @magento['redis']['compress_data'] %>]]></compress_data><!-- 0-9 for compression level, recommended: 0 or 1 -->
                     <compress_tags><![CDATA[<%= @magento['redis']['compress_tags'] %>]]></compress_tags><!-- 0-9 for compression level, recommended: 0 or 1 -->
                     <compress_threshold><![CDATA[<%= @magento['redis']['compress_threshold'] %>]]></compress_threshold><!-- Strings below this size will not be compressed -->
                     <compression_lib><![CDATA[<%= @magento['redis']['compression_lib'] %>]]></compression_lib> <!-- Supports gzip, lzf and snappy -->
                     <lifetimelimit><![CDATA[<%= @magento['redis']['lifetime_limit'] %>]]></lifetimelimit><!-- Lifetime for cache record -->
                     <persistent><![CDATA[<%= @magento['redis']['full_page_cache_persistent'] %>]]></persistent><!-- Specify unique string to enable persistent connections. E.g.: sess-db0; bugs with phpredis and php-fpm are known: https://github.com/nicolasff/phpredis/issues/70 -->
                 </backend_options>
             <% else %>
                 <slow_backend><![CDATA[<%= @magento['app']['slow_backend'] %>]]></slow_backend> <!-- database / file (default) - used for 2 levels cache setup, necessary for all shared memory storages -->
                 <slow_backend_store_data><![CDATA[0]]></slow_backend_store_data>
                 <auto_refresh_fast_cache><![CDATA[0]]></auto_refresh_fast_cache>
                 <lifetime><![CDATA[259200]]></lifetime>
                 <% if @magento['app']['backend_cache'] == "memcached" %>
                     <memcached><!-- memcached cache backend related config -->
                         <servers><!-- any number of server nodes can be included -->
                         <% @magento['app']['backend_servers'].each do |server| %>
                             <server>
                                 <host><![CDATA[<%= server[:host] %>]]></host>
                                 <port><![CDATA[<%= server[:port] %>]]></port>
                                 <persistent><![CDATA[<%= server[:persistent] %>]]></persistent>
                                 <weight><![CDATA[<%= server[:weight] %>]]></weight>
                                 <timeout><![CDATA[<%= server[:timeout] %>]]></timeout>
                                 <retry_interval><![CDATA[<%= server[:retry_interval] %>]]></retry_interval>
                                 <status><![CDATA[<%= server[:status] %>]]></status>
                             </server>
                         <% end %>
                         </servers>
                         <compression><![CDATA[0]]></compression>
                         <cache_dir><![CDATA[]]></cache_dir>
                         <hashed_directory_level><![CDATA[]]></hashed_directory_level>
                         <hashed_directory_umask><![CDATA[]]></hashed_directory_umask>
                         <file_name_prefix><![CDATA[]]></file_name_prefix>
                     </memcached>
                 <% end %>
             <% end %>
             <% if @magento['app']['fpc_prefix'] != nil %><prefix><![CDATA[<%= @magento['app']['fpc_prefix'] %>]]></prefix><% end %>
        </full_page_cache>
    </global>
    <admin>
        <routers>
            <adminhtml>
                <args>
                    <frontName><![CDATA[<%= @magento['app']['admin_frontname'] %>]]></frontName>
                </args>
            </adminhtml>
        </routers>
    </admin>
</config>
